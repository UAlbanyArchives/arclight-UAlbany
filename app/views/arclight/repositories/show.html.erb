<% @page_title = t(:'arclight.views.repositories.show', name: @repository.name) %>
<%= render 'shared/breadcrumbs' %>
<%= render @repository %>

<% content_for(:sidebar) do %>
 <div class="row sticky-nav">
    <div class="col-md-12">
      <section class="sidebar-scroll-wrapper">
        <ul class="list-group">
          <a href="#" class="list-group-item list-group-item-action"><%= @repository.name %></a>
          <% @alpha_collections.keys.each do |letter| %>
            <a href="#<%= letter %>" class="list-group-item list-group-item-action"><%= letter %></a>
          <% end %>
        </ul>
      </section>
    <div>
  </div>
<% end %>

<div class="row al-repository-show-header">
  <div class="col col-md-8 col-lg-9">
    <h2 class="h4">
      <%= t('arclight.views.show.our_collections') %>
    </h2>
  </div>
  <div class="col text-right">
    <span class="al-repository-collections">
      <%= link_to(t(:'arclight.views.repositories.view_all_collections'), repository_collections_path(@repository)) %>
    </span>
  </div>
</div>

<div class="row">
  <div id="documents" class="col-md-8">
    <% @alpha_collections.keys.each do |letter| %>
      <div id="<%= letter %>" class="col-md-12">
        <% @alpha_collections[letter].each do |document| %>
          <article class='al-document-title-bar document'>
            <div class='row'>
              <div class='col-md-10 col-lg-9'>
                <h3 class="h5"><%= link_to document._source["title_filing_si"], solr_document_path(document.id) %></h3>
                <%= content_tag('div', class: 'al-document-abstract-or-scope') do %>
                  <%= content_tag('div', 'data-arclight-truncate' => true) do %>
                    <%= document.abstract_or_scope %>
                  <% end %>
                <% end if document.abstract_or_scope %>
              </div>
              <% if document.unitid %>
                <div class='col text-right al-collection-id'>
                  <%= t(:'arclight.views.show.collection_id', id: document.unitid) %>
                </div>
              <% end %>
            </div>
          </article>
        <% end %>
      </div>
    <% end %>
  </div>
  <div class="col-md-4">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Recent Updates</h5>
        <% @last_collections.each do |document| %>
          <div class="col-md-12">
            <div class='al-document-title-bar'>
              <div class='row'>
                <div class='col-md-10 col-lg-9'>
                  <h3 class="h5"><%= link_to document._source["title_filing_si"], solr_document_path(document.id) %></h3>
                  <%= content_tag('div', class: 'al-document-abstract-or-scope') do %>
                    <%= content_tag('div', 'data-arclight-truncate' => true) do %>
                      <%= document.abstract_or_scope %>
                    <% end %>
                  <% end if document.abstract_or_scope %>
                </div>
                <% if document.unitid %>
                  <div class='col text-right al-collection-id'>
                    <%= t(:'arclight.views.show.collection_id', id: document.unitid) %>
                  </div>
                <% end %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
